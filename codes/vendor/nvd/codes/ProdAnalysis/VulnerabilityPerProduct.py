f = open('./cve_vendProd_ConsIncons_pdd_date.csv', 'rb')

incProd_Vuln, incVend_Vuln, consProd_Vuln, consVend_Vuln, consvendor_prodCount = {}, {}, {}, {}, {}
for line in f:
    line = line.decode().replace('\n', '').rsplit(";")
    cve = line[0]
    incVend = line[1].replace("|", '')
    incProd = line[2].replace("|", '')
    consVend = line[3].replace("|", '')
    consProd = line[4].replace("|", '')
    pdd = line[5]

    if consVend == "":
        consVend = incVend
    if consProd == "":
        consProd = incProd

    if incVend not in incVend_Vuln:
        incVend_Vuln[incVend] = set()
        incVend_Vuln[incVend].add(cve)
    else:
        incVend_Vuln[incVend].add(cve)

    if consVend not in consVend_Vuln:
        consVend_Vuln[consVend] = set()
        consVend_Vuln[consVend].add(cve)
    else:
        consVend_Vuln[consVend].add(cve)

    if incVend+"|"+incProd not in incProd_Vuln:
        incProd_Vuln[incVend+"|"+incProd] = set()
        incProd_Vuln[incVend+"|"+incProd].add(cve)
    else:
        incProd_Vuln[incVend+"|"+incProd].add(cve)

    if consVend+"|"+consProd not in consProd_Vuln:
        consProd_Vuln[consVend+"|"+consProd] = set()
        consProd_Vuln[consVend+"|"+consProd].add(cve)
    else:
        consProd_Vuln[consVend+"|"+consProd].add(cve)

    if consVend not in consvendor_prodCount:
        consvendor_prodCount[consVend] = set()
        consvendor_prodCount[consVend].add(consProd)
    else:
        consvendor_prodCount[consVend].add(consProd)
    # print(line)

# for itm in incProd_Vuln:
#     out = str(itm)+";"+str(len(incProd_Vuln[itm]))
#     with open('./inconsistentProd_VulnCount.csv', 'a') as foo:
#         foo.write(out+'\n')
#
# for itm in consProd_Vuln:
#     out = str(itm)+";"+str(len(consProd_Vuln[itm]))
#     with open('./consistentProd_VulnCount.csv', 'a') as foo:
#         foo.write(out+'\n')

for itm in incProd_Vuln:
    try:
        consCount = len(consProd_Vuln[itm])
    except:
        consCount = 0
    out = str(itm)+";"+str(len(incProd_Vuln[itm]))+";"+str(consCount)
    # with open('./inconsistentProd_VulnCount_correspondingConsCounts.csv', 'a') as foo:
    #     foo.write(out+'\n')

for itm in consvendor_prodCount:
    out = str(itm)+";"+str(len(consvendor_prodCount[itm]))
    with open('./Vendor_ProdCount.csv', 'a') as foo:
        foo.write(out+'\n')

print("Done!!")